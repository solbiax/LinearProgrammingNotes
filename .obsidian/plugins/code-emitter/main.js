"use strict";var H=Object.defineProperty;var z=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var E=(e,t,n)=>(z(e,typeof t!="symbol"?t+"":t,n),n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const obsidian=require("obsidian"),__uno="",style="",name="Code Emitter",version="0.1.4",ClientAgent=`Obsidian ${name}/${version} (Just for programming learning, please let me know if it is not allowed.)`,url$4="https://api.kotlinlang.org//api/1.7.10/compiler/run";async function kotlin(e,t){const s=await(await fetch(url$4,{method:"POST",headers:{"User-Agent":ClientAgent,"Client-Agent":ClientAgent,"content-type":"application/json; charset=utf-8"},body:JSON.stringify({args:"",confType:"java",files:[{name:"File.kt",publicId:"",text:e}]})})).json();if(s.errors&&Object.keys(s.errors).length>0)for(const a of Object.values(s.errors))for(const _ of a)t.error(_.message);t.write(s.text)}const url$3="https://play.rust-lang.org/execute";async function rust(e,t){const s=await(await fetch(url$3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel:"stable",mode:"debug",edition:"2021",crateType:"bin",tests:!1,code:e,backtrace:!1})})).json();t.write(s.success?s.stdout:s.stderr)}const url$2="https://api2.sololearn.com/v2/codeplayground/v2/compile",run$1=async(e,t)=>await(await fetch(url$2,{headers:{"User-Agent":ClientAgent,"Client-Agent":ClientAgent,Accept:"application/json, text/plain, */*","Accept-Language":"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2","Content-Type":"application/json"},body:JSON.stringify({code:e,codeId:null,input:"",language:t}),method:"POST"})).json();async function cpp(e,t){const n=await run$1(e,"cpp");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}async function go(e,t){const n=await run$1(e,"go");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}const nativeGlobal=new Function("return this")(),fnRegexCheckCacheMap=new WeakMap;function isConstructable(e){const t=e.prototype&&e.prototype.constructor===e&&Object.getOwnPropertyNames(e.prototype).length>1;if(t)return!0;if(fnRegexCheckCacheMap.has(e))return fnRegexCheckCacheMap.get(e);let n=t;if(!n){const o=e.toString(),s=/^function\b\s[A-Z].*/,a=/^class\b/;n=s.test(o)||a.test(o)}return fnRegexCheckCacheMap.set(e,n),n}const naughtySafari=typeof document.all=="function"&&typeof document.all>"u",callableFnCacheMap=new WeakMap,isCallable=e=>{if(callableFnCacheMap.has(e))return!0;const t=naughtySafari?typeof e=="function"&&typeof e<"u":typeof e=="function";return t&&callableFnCacheMap.set(e,t),t},boundedMap=new WeakMap;function isBoundedFunction(e){if(boundedMap.has(e))return boundedMap.get(e);const t=e.name.indexOf("bound ")===0&&!e.hasOwnProperty("prototype");return boundedMap.set(e,t),t}const functionBoundedValueMap=new WeakMap;function getTargetValue(e,t){if(isCallable(t)&&!isBoundedFunction(t)&&!isConstructable(t)){const n=functionBoundedValueMap.get(t);if(n)return n;const o=Function.prototype.bind.call(t,e);for(const s in t)o[s]=t[s];if(t.hasOwnProperty("prototype")&&!o.hasOwnProperty("prototype")&&Object.defineProperty(o,"prototype",{value:t.prototype,enumerable:!1,writable:!0}),typeof t.toString=="function"){const s=t.hasOwnProperty("toString")&&!o.hasOwnProperty("toString"),a=o.toString===Function.prototype.toString;if(s||a){const _=Object.getOwnPropertyDescriptor(s?t:Function.prototype,"toString");Object.defineProperty(o,"toString",{..._,..._!=null&&_.get?null:{value:()=>t.toString()}})}}return functionBoundedValueMap.set(t,o),o}return t}function uniq(e){return e.filter(function(n){return n in this?!1:this[n]=!0},Object.create(null))}const rawObjectDefineProperty=Object.defineProperty,NODE_ENV=(typeof process<"u"?process.env.NODE_ENV:void 0)??"production",variableWhiteListInDev=NODE_ENV==="development"||window.__QIANKUN_DEVELOPMENT__?["__REACT_ERROR_OVERLAY_GLOBAL_HOOK__"]:[],variableWhiteList=["System","__cjsWrapper",...variableWhiteListInDev],unscopables={undefined:!0,Array:!0,Object:!0,String:!0,Boolean:!0,Math:!0,Number:!0,Symbol:!0,parseFloat:!0,Float32Array:!0,isNaN:!0,Infinity:!0,Reflect:!0,Float64Array:!0,Function:!0,Map:!0,NaN:!0,Promise:!0,Proxy:!0,Set:!0,parseInt:!0,requestAnimationFrame:!0},scopables={console};function makeScope(e,t){const n=scopables[t];e[t]=new Proxy({},{get(o,s,a){return o[s]??n[s]},set(o,s,a,_){return a===n[s]?delete o[t]:o[s]=a,!0}})}const useNativeWindowForBindingsProps=new Map([["fetch",!0],["mockDomAPIInBlackList",NODE_ENV==="test"]]);function createFakeWindow(e){const t=new Map,n={};return Object.getOwnPropertyNames(e).filter(o=>{if(o in scopables)return!0;const s=Object.getOwnPropertyDescriptor(e,o);return!(s!=null&&s.configurable)}).forEach(o=>{if(o in scopables){makeScope(n,o);return}const s=Object.getOwnPropertyDescriptor(e,o);if(s){const a=Object.prototype.hasOwnProperty.call(s,"get");(o==="top"||o==="parent"||o==="self"||o==="window"||NODE_ENV==="test"&&(o==="mockTop"||o==="mockSafariTop"))&&(s.configurable=!0,a||(s.writable=!0)),a&&t.set(o,!0),rawObjectDefineProperty(n,o,Object.freeze(s))}}),{fakeWindow:n,propertiesWithGetter:t}}let activeSandboxCount=0;class ProxySandbox{constructor(t,n=window){E(this,"updatedValueSet",new Set);E(this,"name");E(this,"proxy");E(this,"globalContext");E(this,"sandboxRunning",!0);E(this,"latestSetProp",null);this.name=t,this.globalContext=n;const{updatedValueSet:o}=this,{fakeWindow:s,propertiesWithGetter:a}=createFakeWindow(n),_=new Map,w=i=>s.hasOwnProperty(i)||n.hasOwnProperty(i),y=new Proxy(s,{set:(i,c,l)=>{if(this.sandboxRunning){if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)){const x=Object.getOwnPropertyDescriptor(n,c),{writable:P,configurable:j,enumerable:k}=x;P&&Object.defineProperty(i,c,{configurable:j,enumerable:k,writable:P,value:l})}else i[c]=l;return variableWhiteList.indexOf(c)!==-1&&(n[c]=l),o.add(c),this.latestSetProp=c,!0}return NODE_ENV==="development"&&console.warn(`[qiankun] Set window.${c.toString()} while sandbox destroyed or inactive in ${t}!`),!0},get:(i,c)=>{if(c===Symbol.unscopables)return unscopables;if(c==="window"||c==="self"||c==="globalThis")return y;if(c==="top"||c==="parent"||NODE_ENV==="test"&&(c==="mockTop"||c==="mockSafariTop"))return n===n.parent?y:n[c];if(c==="hasOwnProperty")return w;if(c==="document")return document;if(c==="eval")return eval;const l=a.has(c)?n[c]:c in i?i[c]:n[c],x=useNativeWindowForBindingsProps.get(c)?nativeGlobal:n;return getTargetValue(x,l)},has(i,c){return c in unscopables||c in i||c in n},getOwnPropertyDescriptor(i,c){if(i.hasOwnProperty(c)){const l=Object.getOwnPropertyDescriptor(i,c);return _.set(c,"target"),l}if(n.hasOwnProperty(c)){const l=Object.getOwnPropertyDescriptor(n,c);return _.set(c,"globalContext"),l&&!l.configurable&&(l.configurable=!0),l}},ownKeys(i){return uniq(Reflect.ownKeys(n).concat(Reflect.ownKeys(i)))},defineProperty(i,c,l){switch(_.get(c)){case"globalContext":return Reflect.defineProperty(n,c,l);default:return Reflect.defineProperty(i,c,l)}},deleteProperty:(i,c)=>(i.hasOwnProperty(c)&&(delete i[c],o.delete(c)),!0),getPrototypeOf(){return Reflect.getPrototypeOf(n)}});this.proxy=y,activeSandboxCount++}active(){this.sandboxRunning||activeSandboxCount++,this.sandboxRunning=!0}inactive(){NODE_ENV==="development"&&console.info(`[qiankun:sandbox] ${this.name} modified global properties restore...`,[...this.updatedValueSet.keys()]),--activeSandboxCount===0&&variableWhiteList.forEach(t=>{this.proxy.hasOwnProperty(t)&&delete this.globalContext[t]}),this.sandboxRunning=!1}}async function js(code,output){return new Promise((resolve,reject)=>{const sandbox=new ProxySandbox("t");let run=async function(window){const{console}=window;Object.assign(console,output),sandbox.active();try{await eval(code)}catch(e){console.error(e)}finally{sandbox.inactive()}};run=run.bind(sandbox.proxy),run(sandbox.proxy).then(resolve).catch(reject)})}function urlImport(e,t){return new Promise((n,o)=>{document.head.querySelector(`script[src="${e}"]`)&&n(t?t():void 0);const s=document.createElement("script");s.src=e,s.onload=function(){n(t?t():void 0)},document.head.append(s)})}const cdn$2="https://cdn.jsdelivr.net/npm/typescript@4.7.4/lib/typescript.min.js",ts=function(){let e=null,t=null;const n=async function(o,s){e||await t();const a=e.transpile(`(async () => { ${o} })();`,{module:e.ModuleKind.ESNext,target:e.ScriptTarget.ES2018});await js(a,s)};return n.loading=!0,t=async()=>{e=await urlImport(cdn$2,()=>window.ts),n.loading=!1,console.log("typescript loaded.")},n}();async function java(e,t){const n=await run$1(e,"java");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}typeof process<"u"&&typeof process.browser>"u"&&(process.browser=!0);const cdn$1="https://cdn.jsdelivr.net/gh/mokeyish/pyodide-dist@0.21.2/",python=function(){let e=null,t=null,n=null;const o=async(s,a)=>{e||await n(),t=a;try{await e.runPythonAsync(s)}catch(_){a.error(_)}};return o.loading=!0,n=async()=>{e=await(await urlImport(`${cdn$1}pyodide.js`,()=>window.loadPyodide))({indexURL:cdn$1,stdout:a=>t==null?void 0:t.write(a),stderr:a=>t==null?void 0:t.error(a)}),await e.loadPackage("micropip"),console.log("python loaded."),o.loading=!1},o}();async function csharp(e,t){const n=await run$1(e,"cs");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}async function swift(e,t){const n=await run$1(e,"swift");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}const url$1="https://play.vosca.dev/run";async function v(e,t){var a;const n=new FormData;n.append("code",e);const s=await(await fetch(url$1,{method:"POST",body:n})).json();((a=s.error)==null?void 0:a.length)>0?t.error(s.error):t.write(s.output)}const cdn="https://unpkg.com/@wenyan/core/index.min.js",wy=function(){let e=null,t=null;const n=async function(o,s){e||await t();const a=e.compile(o);console.log("wenyan:"),console.log(a),await js(`(async () => { ${a} })();`,s)};return n.loading=!0,t=async()=>{e=await urlImport(cdn,()=>window.Wenyan),n.loading=!1,console.log("wenyan loaded.")},n}(),url="https://play.crystal-lang.org/run_requests";async function crystal(e,t){const a=(await(await fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({run_request:{language:"crystal",version:"1.8.2",code:e}})})).json()).run_request.run;t.write(a.stderr?a.stderr:a.stdout)}async function r(e,t){const n=await run$1(e,"r");t.write(n.success?n.data.output:(n.errors??[]).join(`
`))}const languages={kotlin,rust,java,c:cpp,cpp,"c++":cpp,csharp,"c#":csharp,js,javascript:js,ts,typescript:ts,python,go,swift,v,vlang:v,wy,wenyan:wy,crystal,cr:crystal,r,R:r};function noop(){}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return typeof e=="function"}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function is_empty(e){return Object.keys(e).length===0}function append(e,t){e.appendChild(t)}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode&&e.parentNode.removeChild(e)}function destroy_each(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function listen(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function attr(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function children(e){return Array.from(e.childNodes)}function toggle_class(e,t,n){e.classList[n?"add":"remove"](t)}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function onDestroy(e){get_current_component().$$.on_destroy.push(e)}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0;function flush(){if(flushidx!==0)return;const e=current_component;do{try{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}}catch(t){throw dirty_components.length=0,flushidx=0,t}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const n=render_callbacks[t];seen_callbacks.has(n)||(seen_callbacks.add(n),n())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(e.fragment!==null){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}function flush_render_callbacks(e){const t=[],n=[];render_callbacks.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),render_callbacks=t}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,n,o){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function create_component(e){e&&e.c()}function mount_component(e,t,n,o){const{fragment:s,after_update:a}=e.$$;s&&s.m(t,n),o||add_render_callback(()=>{const _=e.$$.on_mount.map(run).filter(is_function);e.$$.on_destroy?e.$$.on_destroy.push(..._):run_all(_),e.$$.on_mount=[]}),a.forEach(add_render_callback)}function destroy_component(e,t){const n=e.$$;n.fragment!==null&&(flush_render_callbacks(n.after_update),run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function make_dirty(e,t){e.$$.dirty[0]===-1&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,o,s,a,_,w=[-1]){const y=current_component;set_current_component(e);const i=e.$$={fragment:null,ctx:[],props:a,update:noop,not_equal:s,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(y?y.$$.context:[])),callbacks:blank_object(),dirty:w,skip_bound:!1,root:t.target||y.$$.root};_&&_(i.root);let c=!1;if(i.ctx=n?n(e,t.props||{},(l,x,...P)=>{const j=P.length?P[0]:x;return i.ctx&&s(i.ctx[l],i.ctx[l]=j)&&(!i.skip_bound&&i.bound[l]&&i.bound[l](j),c&&make_dirty(e,l)),x}):[],i.update(),c=!0,run_all(i.before_update),i.fragment=o?o(i.ctx):!1,t.target){if(t.hydrate){const l=children(t.target);i.fragment&&i.fragment.l(l),l.forEach(detach)}else i.fragment&&i.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(y)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(t,n){if(!is_function(n))return noop;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const subscriber_queue=[];function writable(e,t=noop){let n;const o=new Set;function s(w){if(safe_not_equal(e,w)&&(e=w,n)){const y=!subscriber_queue.length;for(const i of o)i[1](),subscriber_queue.push(i,e);if(y){for(let i=0;i<subscriber_queue.length;i+=2)subscriber_queue[i][0](subscriber_queue[i+1]);subscriber_queue.length=0}}}function a(w){s(w(e))}function _(w,y=noop){const i=[w,y];return o.add(i),o.size===1&&(n=t(s)||noop),w(e),()=>{o.delete(i),o.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:_}}function createCodeOutput(){const{subscribe:e,set:t,update:n}=writable([]),o=(l,x)=>{const P=`<div class="log-${l}">${x.join(",")}</div>`;n(j=>[...j,P])};return{subscribe:e,log:(...l)=>o("info",l),info:(...l)=>o("info",l),debug:(...l)=>o("debug",l),warn:(...l)=>o("warn",l),error:(...l)=>o("error",l),write:(...l)=>{const x=l.join(",");n(P=>[...P,x])},clear:()=>{t([])},set:t}}const backend={...languages},CodeRunning_svelte_svelte_type_style_lang="";function create_fragment$2(e){let t;return{c(){t=element("div"),t.innerHTML=`<div class="dot svelte-15rvtmc"></div> 
  <div class="dot svelte-15rvtmc"></div> 
  <div class="dot svelte-15rvtmc"></div> 
  <div class="dot svelte-15rvtmc"></div>`,attr(t,"class","lds-ellipsis svelte-15rvtmc")},m(n,o){insert(n,t,o)},p:noop,i:noop,o:noop,d(n){n&&detach(t)}}}class CodeRunning extends SvelteComponent{constructor(t){super(),init(this,t,null,create_fragment$2,safe_not_equal,{})}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var md5$1={exports:{}};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var core={exports:{}},hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(e,t){(function(n,o){e.exports=o()})(commonjsGlobal,function(){var n=n||function(o,s){var a;if(typeof window<"u"&&window.crypto&&(a=window.crypto),typeof self<"u"&&self.crypto&&(a=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window<"u"&&window.msCrypto&&(a=window.msCrypto),!a&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(a=commonjsGlobal.crypto),!a&&typeof commonjsRequire=="function")try{a=require("crypto")}catch{}var _=function(){if(a){if(typeof a.getRandomValues=="function")try{return a.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof a.randomBytes=="function")try{return a.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},w=Object.create||function(){function u(){}return function(g){var b;return u.prototype=g,b=new u,u.prototype=null,b}}(),y={},i=y.lib={},c=i.Base=function(){return{extend:function(u){var g=w(this);return u&&g.mixIn(u),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var u=this.extend();return u.init.apply(u,arguments),u},init:function(){},mixIn:function(u){for(var g in u)u.hasOwnProperty(g)&&(this[g]=u[g]);u.hasOwnProperty("toString")&&(this.toString=u.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=i.WordArray=c.extend({init:function(u,g){u=this.words=u||[],g!=s?this.sigBytes=g:this.sigBytes=u.length*4},toString:function(u){return(u||P).stringify(this)},concat:function(u){var g=this.words,b=u.words,S=this.sigBytes,O=u.sigBytes;if(this.clamp(),S%4)for(var C=0;C<O;C++){var B=b[C>>>2]>>>24-C%4*8&255;g[S+C>>>2]|=B<<24-(S+C)%4*8}else for(var T=0;T<O;T+=4)g[S+T>>>2]=b[T>>>2];return this.sigBytes+=O,this},clamp:function(){var u=this.words,g=this.sigBytes;u[g>>>2]&=4294967295<<32-g%4*8,u.length=o.ceil(g/4)},clone:function(){var u=c.clone.call(this);return u.words=this.words.slice(0),u},random:function(u){for(var g=[],b=0;b<u;b+=4)g.push(_());return new l.init(g,u)}}),x=y.enc={},P=x.Hex={stringify:function(u){for(var g=u.words,b=u.sigBytes,S=[],O=0;O<b;O++){var C=g[O>>>2]>>>24-O%4*8&255;S.push((C>>>4).toString(16)),S.push((C&15).toString(16))}return S.join("")},parse:function(u){for(var g=u.length,b=[],S=0;S<g;S+=2)b[S>>>3]|=parseInt(u.substr(S,2),16)<<24-S%8*4;return new l.init(b,g/2)}},j=x.Latin1={stringify:function(u){for(var g=u.words,b=u.sigBytes,S=[],O=0;O<b;O++){var C=g[O>>>2]>>>24-O%4*8&255;S.push(String.fromCharCode(C))}return S.join("")},parse:function(u){for(var g=u.length,b=[],S=0;S<g;S++)b[S>>>2]|=(u.charCodeAt(S)&255)<<24-S%4*8;return new l.init(b,g)}},k=x.Utf8={stringify:function(u){try{return decodeURIComponent(escape(j.stringify(u)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(u){return j.parse(unescape(encodeURIComponent(u)))}},m=i.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(u){typeof u=="string"&&(u=k.parse(u)),this._data.concat(u),this._nDataBytes+=u.sigBytes},_process:function(u){var g,b=this._data,S=b.words,O=b.sigBytes,C=this.blockSize,B=C*4,T=O/B;u?T=o.ceil(T):T=o.max((T|0)-this._minBufferSize,0);var $=T*C,q=o.min($*4,O);if($){for(var N=0;N<$;N+=C)this._doProcessBlock(S,N);g=S.splice(0,$),b.sigBytes-=q}return new l.init(g,q)},clone:function(){var u=c.clone.call(this);return u._data=this._data.clone(),u},_minBufferSize:0});i.Hasher=m.extend({cfg:c.extend(),init:function(u){this.cfg=this.cfg.extend(u),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(u){return this._append(u),this._process(),this},finalize:function(u){u&&this._append(u);var g=this._doFinalize();return g},blockSize:16,_createHelper:function(u){return function(g,b){return new u.init(b).finalize(g)}},_createHmacHelper:function(u){return function(g,b){return new R.HMAC.init(u,b).finalize(g)}}});var R=y.algo={};return y}(Math);return n})}(core)),core.exports}(function(e,t){(function(n,o){e.exports=o(requireCore())})(commonjsGlobal,function(n){return function(o){var s=n,a=s.lib,_=a.WordArray,w=a.Hasher,y=s.algo,i=[];(function(){for(var k=0;k<64;k++)i[k]=o.abs(o.sin(k+1))*4294967296|0})();var c=y.MD5=w.extend({_doReset:function(){this._hash=new _.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(k,m){for(var R=0;R<16;R++){var u=m+R,g=k[u];k[u]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var b=this._hash.words,S=k[m+0],O=k[m+1],C=k[m+2],B=k[m+3],T=k[m+4],$=k[m+5],q=k[m+6],N=k[m+7],D=k[m+8],M=k[m+9],A=k[m+10],W=k[m+11],F=k[m+12],L=k[m+13],I=k[m+14],V=k[m+15],d=b[0],f=b[1],p=b[2],h=b[3];d=l(d,f,p,h,S,7,i[0]),h=l(h,d,f,p,O,12,i[1]),p=l(p,h,d,f,C,17,i[2]),f=l(f,p,h,d,B,22,i[3]),d=l(d,f,p,h,T,7,i[4]),h=l(h,d,f,p,$,12,i[5]),p=l(p,h,d,f,q,17,i[6]),f=l(f,p,h,d,N,22,i[7]),d=l(d,f,p,h,D,7,i[8]),h=l(h,d,f,p,M,12,i[9]),p=l(p,h,d,f,A,17,i[10]),f=l(f,p,h,d,W,22,i[11]),d=l(d,f,p,h,F,7,i[12]),h=l(h,d,f,p,L,12,i[13]),p=l(p,h,d,f,I,17,i[14]),f=l(f,p,h,d,V,22,i[15]),d=x(d,f,p,h,O,5,i[16]),h=x(h,d,f,p,q,9,i[17]),p=x(p,h,d,f,W,14,i[18]),f=x(f,p,h,d,S,20,i[19]),d=x(d,f,p,h,$,5,i[20]),h=x(h,d,f,p,A,9,i[21]),p=x(p,h,d,f,V,14,i[22]),f=x(f,p,h,d,T,20,i[23]),d=x(d,f,p,h,M,5,i[24]),h=x(h,d,f,p,I,9,i[25]),p=x(p,h,d,f,B,14,i[26]),f=x(f,p,h,d,D,20,i[27]),d=x(d,f,p,h,L,5,i[28]),h=x(h,d,f,p,C,9,i[29]),p=x(p,h,d,f,N,14,i[30]),f=x(f,p,h,d,F,20,i[31]),d=P(d,f,p,h,$,4,i[32]),h=P(h,d,f,p,D,11,i[33]),p=P(p,h,d,f,W,16,i[34]),f=P(f,p,h,d,I,23,i[35]),d=P(d,f,p,h,O,4,i[36]),h=P(h,d,f,p,T,11,i[37]),p=P(p,h,d,f,N,16,i[38]),f=P(f,p,h,d,A,23,i[39]),d=P(d,f,p,h,L,4,i[40]),h=P(h,d,f,p,S,11,i[41]),p=P(p,h,d,f,B,16,i[42]),f=P(f,p,h,d,q,23,i[43]),d=P(d,f,p,h,M,4,i[44]),h=P(h,d,f,p,F,11,i[45]),p=P(p,h,d,f,V,16,i[46]),f=P(f,p,h,d,C,23,i[47]),d=j(d,f,p,h,S,6,i[48]),h=j(h,d,f,p,N,10,i[49]),p=j(p,h,d,f,I,15,i[50]),f=j(f,p,h,d,$,21,i[51]),d=j(d,f,p,h,F,6,i[52]),h=j(h,d,f,p,B,10,i[53]),p=j(p,h,d,f,A,15,i[54]),f=j(f,p,h,d,O,21,i[55]),d=j(d,f,p,h,D,6,i[56]),h=j(h,d,f,p,V,10,i[57]),p=j(p,h,d,f,q,15,i[58]),f=j(f,p,h,d,L,21,i[59]),d=j(d,f,p,h,T,6,i[60]),h=j(h,d,f,p,W,10,i[61]),p=j(p,h,d,f,C,15,i[62]),f=j(f,p,h,d,M,21,i[63]),b[0]=b[0]+d|0,b[1]=b[1]+f|0,b[2]=b[2]+p|0,b[3]=b[3]+h|0},_doFinalize:function(){var k=this._data,m=k.words,R=this._nDataBytes*8,u=k.sigBytes*8;m[u>>>5]|=128<<24-u%32;var g=o.floor(R/4294967296),b=R;m[(u+64>>>9<<4)+15]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,m[(u+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,k.sigBytes=(m.length+1)*4,this._process();for(var S=this._hash,O=S.words,C=0;C<4;C++){var B=O[C];O[C]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return S},clone:function(){var k=w.clone.call(this);return k._hash=this._hash.clone(),k}});function l(k,m,R,u,g,b,S){var O=k+(m&R|~m&u)+g+S;return(O<<b|O>>>32-b)+m}function x(k,m,R,u,g,b,S){var O=k+(m&u|R&~u)+g+S;return(O<<b|O>>>32-b)+m}function P(k,m,R,u,g,b,S){var O=k+(m^R^u)+g+S;return(O<<b|O>>>32-b)+m}function j(k,m,R,u,g,b,S){var O=k+(R^(m|~u))+g+S;return(O<<b|O>>>32-b)+m}s.MD5=w._createHelper(c),s.HmacMD5=w._createHmacHelper(c)}(Math),n.MD5})})(md5$1);var md5Exports=md5$1.exports;const md5=getDefaultExportFromCjs(md5Exports),RunWidget_svelte_svelte_type_style_lang="";function get_each_context(e,t,n){const o=e.slice();return o[13]=t[n],o}function create_if_block_2(e){let t,n,o;return{c(){t=element("i"),attr(t,"class","button-run-code i-fa6-solid:play svelte-gh2wmv")},m(s,a){insert(s,t,a),n||(o=listen(t,"click",e[4]),n=!0)},p:noop,d(s){s&&detach(t),n=!1,o()}}}function create_if_block(e){let t,n,o,s,a,_;const w=[create_if_block_1,create_else_block],y=[];function i(c,l){return c[1]?0:1}return s=i(e),a=y[s]=w[s](e),{c(){t=element("hr"),n=space(),o=element("div"),a.c(),attr(t,"class","seprator svelte-gh2wmv"),attr(o,"class","code-output svelte-gh2wmv")},m(c,l){insert(c,t,l),insert(c,n,l),insert(c,o,l),y[s].m(o,null),_=!0},p(c,l){let x=s;s=i(c),s===x?y[s].p(c,l):(group_outros(),transition_out(y[x],1,1,()=>{y[x]=null}),check_outros(),a=y[s],a?a.p(c,l):(a=y[s]=w[s](c),a.c()),transition_in(a,1),a.m(o,null))},i(c){_||(transition_in(a),_=!0)},o(c){transition_out(a),_=!1},d(c){c&&detach(t),c&&detach(n),c&&detach(o),y[s].d()}}}function create_else_block(e){let t,n,o,s,a,_=e[0],w=[];for(let y=0;y<_.length;y+=1)w[y]=create_each_block(get_each_context(e,_,y));return{c(){t=element("i"),n=space(),o=element("ul");for(let y=0;y<w.length;y+=1)w[y].c();attr(t,"class","button-refresh-code i-fa6-solid:xmark svelte-gh2wmv"),attr(o,"class","svelte-gh2wmv")},m(y,i){insert(y,t,i),insert(y,n,i),insert(y,o,i);for(let c=0;c<w.length;c+=1)w[c]&&w[c].m(o,null);s||(a=listen(t,"click",e[3].clear),s=!0)},p(y,i){if(i&1){_=y[0];let c;for(c=0;c<_.length;c+=1){const l=get_each_context(y,_,c);w[c]?w[c].p(l,i):(w[c]=create_each_block(l),w[c].c(),w[c].m(o,null))}for(;c<w.length;c+=1)w[c].d(1);w.length=_.length}},i:noop,o:noop,d(y){y&&detach(t),y&&detach(n),y&&detach(o),destroy_each(w,y),s=!1,a()}}}function create_if_block_1(e){let t,n,o;return n=new CodeRunning({}),{c(){t=element("div"),create_component(n.$$.fragment),attr(t,"class","loadding svelte-gh2wmv")},m(s,a){insert(s,t,a),mount_component(n,t,null),o=!0},p:noop,i(s){o||(transition_in(n.$$.fragment,s),o=!0)},o(s){transition_out(n.$$.fragment,s),o=!1},d(s){s&&detach(t),destroy_component(n)}}}function create_each_block(e){let t,n=e[13]+"";return{c(){t=element("li"),attr(t,"class","svelte-gh2wmv")},m(o,s){insert(o,t,s),t.innerHTML=n},p(o,s){s&1&&n!==(n=o[13]+"")&&(t.innerHTML=n)},d(o){o&&detach(t)}}}function create_fragment$1(e){let t,n,o,s=!e[1]&&!e[2]&&create_if_block_2(e),a=(e[1]||e[2])&&create_if_block(e);return{c(){t=element("div"),s&&s.c(),n=space(),a&&a.c(),attr(t,"class","code-emitter-block svelte-gh2wmv")},m(_,w){insert(_,t,w),s&&s.m(t,null),append(t,n),a&&a.m(t,null),o=!0},p(_,[w]){!_[1]&&!_[2]?s?s.p(_,w):(s=create_if_block_2(_),s.c(),s.m(t,n)):s&&(s.d(1),s=null),_[1]||_[2]?a?(a.p(_,w),w&6&&transition_in(a,1)):(a=create_if_block(_),a.c(),transition_in(a,1),a.m(t,null)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros())},i(_){o||(transition_in(a),o=!0)},o(_){transition_out(a),o=!1},d(_){_&&detach(t),s&&s.d(),a&&a.d()}}}function instance$1(e,t,n){let o,s,a,{lang:_}=t,{code:w}=t,{sourcePath:y}=t,{autoRun:i=!1}=t;const c=createCodeOutput();let l;c.subscribe(m=>n(0,l=m));let x=!1;const P=async()=>{n(1,x=!0),await backend[_](w,c),n(1,x=!1)},j=()=>{const m=localStorage.getItem(o);if(!m)return;const u=JSON.parse(m)[s];if(u)return u.outputs},k=()=>{const m=localStorage.getItem(o),R=m?JSON.parse(m):{};R[s]={outputs:l,lastAccessTime:Date.now()},localStorage.setItem(o,JSON.stringify(R))};return onMount(async()=>{const m=j();m?c.set(m):i&&await P()}),onDestroy(k),e.$$set=m=>{"lang"in m&&n(5,_=m.lang),"code"in m&&n(6,w=m.code),"sourcePath"in m&&n(7,y=m.sourcePath),"autoRun"in m&&n(8,i=m.autoRun)},e.$$.update=()=>{e.$$.dirty&128&&(o=`code-emitter-cache-${y}`),e.$$.dirty&64&&(s=md5(w).toString()),e.$$.dirty&1&&n(2,a=l.length>0)},[l,x,a,c,P,_,w,y,i]}class RunWidget extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{lang:5,code:6,sourcePath:7,autoRun:8})}}const SETTING_DEFAULT={autoRun:!1};function create_fragment(e){let t,n,o,s,a,_,w,y,i;return{c(){t=element("div"),n=element("div"),n.innerHTML=`<div class="setting-item-name">Auto run</div> 
        <div class="setting-item-description">Automatically run markdown CodeBlock</div>`,o=space(),s=element("div"),a=element("div"),_=element("input"),attr(n,"class","setting-item-info"),attr(_,"type","checkbox"),_.value=w=e[0].autoRun,attr(a,"class","checkbox-container"),toggle_class(a,"is-enabled",e[0].autoRun),attr(s,"class","setting-item-control"),attr(t,"class","setting-item mod-toggle")},m(c,l){insert(c,t,l),append(t,n),append(t,o),append(t,s),append(s,a),append(a,_),y||(i=listen(a,"click",e[1]),y=!0)},p(c,[l]){l&1&&w!==(w=c[0].autoRun)&&(_.value=w),l&1&&toggle_class(a,"is-enabled",c[0].autoRun)},i:noop,o:noop,d(c){c&&detach(t),y=!1,i()}}}function instance(e,t,n){let{settings:o=SETTING_DEFAULT}=t;const s=()=>n(0,o.autoRun=!o.autoRun,o);return e.$$set=a=>{"settings"in a&&n(0,o=a.settings)},[o,s]}class SettingTab extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{settings:0})}}const langPrefix="language-";class CodeEmitterPlugin extends obsidian.Plugin{constructor(){super(...arguments);E(this,"settings")}async injectRunCode(n,o){const s=n.querySelector("pre>code");if(s&&s.className.startsWith(langPrefix)){const a=s.className.substring(langPrefix.length).toLowerCase();backend[a]&&o.addChild(new CodeRunWidgetView(this,s.parentElement,a,s.getText(),o.sourcePath))}}async onload(){await this.loadSettings(),this.addSettingTab(new SettingTabView(this.app,this)),this.registerMarkdownPostProcessor(this.injectRunCode.bind(this),-1)}async unload(){await this.saveSettings(),super.unload()}async loadSettings(){this.settings=Object.assign({},SETTING_DEFAULT,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}}class SettingTabView extends obsidian.PluginSettingTab{constructor(n,o){super(n,o);E(this,"plugin");E(this,"view");this.plugin=o}display(){const{containerEl:n}=this;this.view=new SettingTab({target:n,props:{settings:this.plugin.settings}})}hide(){var n;return(n=this.view)==null||n.$destroy(),super.hide()}}class CodeRunWidgetView extends obsidian.MarkdownRenderChild{constructor(n,o,s,a,_){super(o);E(this,"plugin");E(this,"widget");E(this,"lang");E(this,"code");E(this,"sourcePath");this.plugin=n,this.lang=s,this.code=a,this.sourcePath=_}onload(){const{containerEl:n,lang:o,code:s,sourcePath:a}=this;this.widget=new RunWidget({target:n,props:{lang:o,code:s,sourcePath:a,autoRun:this.plugin.settings.autoRun}})}onunload(){var n;(n=this.widget)==null||n.$destroy()}}exports.SettingTabView=SettingTabView;exports.default=CodeEmitterPlugin;
